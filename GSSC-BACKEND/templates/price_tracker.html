{% extends "base.html" %}

{% block title %}Price Tracker | GSSC{% endblock %}
{% block header_title %}Solar Price Tracker{% endblock %}

{% block extra_css %}
<style>
.price-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
  gap:22px;
}

/* Price Card */
.price-card{
  background:linear-gradient(180deg,#020617,#020617cc);
  padding:24px;
  border-radius:22px;
  box-shadow:0 25px 50px rgba(0,0,0,.55);
  transition:.3s;
}

.price-card:hover{
  transform:translateY(-6px);
}

.price-card h5{
  margin-bottom:4px;
}

.price{
  font-size:22px;
  font-weight:600;
  color:#22c55e;
}

/* Tag */
.tag{
  display:inline-block;
  margin-top:12px;
  padding:6px 14px;
  border-radius:999px;
  font-size:12px;
  background:rgba(34,197,94,.15);
  color:#86efac;
}

/* Filter Buttons */
.filter-bar{
  display:flex;
  gap:14px;
  margin-bottom:30px;
  flex-wrap:wrap;
}

.filter-bar a{
  padding:10px 18px;
  border-radius:999px;
  background:#020617;
  color:#94a3b8;
  font-size:14px;
  text-decoration:none;
  border:1px solid rgba(148,163,184,.15);
  transition:.25s;
}

.filter-bar a.active,
.filter-bar a:hover{
  background:rgba(34,197,94,.15);
  color:#86efac;
  border-color:rgba(34,197,94,.4);
}

/* Specs */
.specs{
  font-size:13px;
  color:#9ca3af;
  margin-top:14px;
  line-height:1.7;
}

/* Update Prices Button */
.action-btn{
  display:inline-block;
  margin-top:20px;
  padding:12px 24px;
  border-radius:999px;
  background:#22c55e;
  color:#020617;
  font-weight:600;
  text-decoration:none;
  transition:.3s;
}

.action-btn:hover{
  background:#16a34a;
  color:#ffffff;
}
</style>
{% endblock %}

{% block content %}

<p class="text-secondary mb-4">
  Track real-time market prices and technical specifications of solar panels, inverters, and batteries.
</p>

<!-- Filter Buttons -->
<div class="filter-bar">
  <a href="{% url 'price_tracker_url' %}" class="{% if not selected_type %}active{% endif %}">All</a>
  <a href="?type=solar_panel" class="{% if selected_type == 'solar_panel' %}active{% endif %}">Solar Panels</a>
  <a href="?type=inverter" class="{% if selected_type == 'inverter' %}active{% endif %}">Inverters</a>
  <a href="?type=battery" class="{% if selected_type == 'battery' %}active{% endif %}">Batteries</a>
</div>

<!-- Products Grid -->
<div class="price-grid">

  {% for product in products %}
  <div class="price-card">

    <h5>{{ product.company }}</h5>
    <small class="text-secondary">{{ product.model }}</small>

    {% if product.price %}
      <div class="price mt-2">Rs. {{ product.price|floatformat:0 }}</div>
    {% else %}
      <div class="price mt-2 text-secondary">Price on Request</div>
    {% endif %}

    <div class="specs">
      {% if product.max_power %}
        <div><strong>Power:</strong> {{ product.max_power }}</div>
      {% endif %}
      {% if product.cell_type %}
        <div><strong>Cell Type:</strong> {{ product.cell_type }}</div>
      {% endif %}
      {% if product.glass_thickness %}
        <div><strong>Glass:</strong> {{ product.glass_thickness }}</div>
      {% endif %}
      {% if product.max_system_voltage %}
        <div><strong>System Voltage:</strong> {{ product.max_system_voltage }}</div>
      {% endif %}
      {% if product.operating_temperature %}
        <div><strong>Temp Range:</strong> {{ product.operating_temperature }}</div>
      {% endif %}
      {% if product.efficiency %}
        <div><strong>Efficiency:</strong> {{ product.efficiency }}</div>
      {% endif %}
      {% if product.type %}
        <div><strong>Type:</strong> {{ product.type }}</div>
      {% endif %}
    </div>

    {% if product.features %}
      <div class="specs mt-2">
        <strong>Features:</strong><br>
        {{ product.features }}
      </div>
    {% endif %}

    {% if product.website %}
      <div class="mt-3">
        <a href="{{ product.website }}" target="_blank" class="text-success">
          View Official Website â†’
        </a>
      </div>
    {% endif %}

    <div class="tag">
      {{ product.get_category_display }}
    </div>

  </div>
  {% empty %}
    <p class="text-secondary">No products found.</p>
  {% endfor %}

</div>

<a href="{% url 'update_prices_url' %}" class="action-btn">
  Update Prices
</a>

{% endblock %}
